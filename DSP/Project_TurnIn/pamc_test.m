function y = pamc_test(x)
%PAMC_TEST Filters input x and returns output y.

% MATLAB Code
% Generated by MATLAB(R) 8.6 and the DSP System Toolbox 9.1.
% Generated on: 13-Dec-2015 14:59:22

%#codegen

% To generate C/C++ code from this function use the codegen command. Type
% 'help codegen' for more information.

persistent Hd;

if isempty(Hd)
    
    % The following code was used to design the filter coefficients:
    % % Equiripple Bandstop filter designed using the FIRPM function.
    %
    % % All frequency values are in Hz.
    % Fs = 11025;  % Sampling Frequency
    %
    % Fpass1 = 1400;            % First Passband Frequency
    % Fstop1 = 1600;            % First Stopband Frequency
    % Fstop2 = 1700;            % Second Stopband Frequency
    % Fpass2 = 1900;            % Second Passband Frequency
    % Dpass1 = 0.028774368332;  % First Passband Ripple
    % Dstop  = 1e-05;           % Stopband Attenuation
    % Dpass2 = 0.028774368332;  % Second Passband Ripple
    % dens   = 16;              % Density Factor
    %
    % % Calculate the order from the parameters using FIRPMORD.
    % [N, Fo, Ao, W] = firpmord([Fpass1 Fstop1 Fstop2 Fpass2]/(Fs/2), [1 0 ...
    %                           1], [Dpass1 Dstop Dpass2]);
    %
    % % Calculate the coefficients using the FIRPM function.
    % b  = firpm(N, Fo, Ao, W, {dens});
    
    Hd = dsp.FIRFilter( ...
        'Numerator', [0.000160039296235752 -0.00327340841804536 ...
        -0.000418939383951311 7.62383463167554e-05 0.00034481604936328 ...
        0.000289614943313885 3.08502314606061e-05 -0.000136363890798895 ...
        -8.27111237553569e-05 1.48238319635741e-05 -8.22222836667422e-05 ...
        -0.000319974678743598 -0.000335852091838317 0.000121390111571906 ...
        0.000772704745451151 0.000928629717009743 0.000172160585434293 ...
        -0.00104910222775769 -0.00163664876285667 -0.000821743041045206 ...
        0.000947901936010082 0.0021940592435902 0.00166793510114932 ...
        -0.000403436556624593 -0.00233523032602963 -0.00240257145250944 ...
        -0.000434532578079916 0.00193562101095158 0.00268448846989101 ...
        0.00121747194984811 -0.00111729563257338 -0.0023064443384796 ...
        -0.00151864465237471 0.000256517990117414 0.001335064714034 ...
        0.00102248283081354 0.000127790833184467 -0.000156418762417842 ...
        0.000292503605352975 0.000412732919244857 -0.000622836430686504 ...
        -0.00206103907539546 -0.00202226276401295 0.000406452624585443 ...
        0.00360419467398028 0.00439411551312249 0.00110944324203413 ...
        -0.00416658326482286 -0.00680156703230628 -0.00372171702732933 ...
        0.00324917451024706 0.00832777966880916 0.00668978628521422 ...
        -0.000899680300288119 -0.00824204533250936 -0.00894025357560687 ...
        -0.00217243267736483 0.00637370842026181 0.00946434480608708 ...
        0.00474219424105215 -0.00333880346249821 -0.00778285069564525 ...
        -0.00547801558023553 0.000467573968422727 0.00432497424255977 ...
        0.00350850073093174 0.00056304049183348 -0.000435632453540443 ...
        0.00111246327165822 0.00164397875772264 -0.00189017714350953 ...
        -0.00716927379385937 -0.00758292185658081 0.00066004397733961 ...
        0.0124768627619328 0.0164322124952787 0.0053695710981417 ...
        -0.0144700682726484 -0.0260611545538405 -0.0160732839479668 ...
        0.0110306483902122 0.0334992132824031 0.0297329652336371 ...
        -0.00130617627483517 -0.0357892839180725 -0.0433211651403085 ...
        -0.0138078286840283 0.0309376486496485 0.0532714462599265 ...
        0.0316991385855097 -0.0186626069377135 -0.0565028764199159 ...
        -0.0486298586989787 0.000665620483072021 0.0513866085268384 ...
        0.0607355636607642 0.0197056878852779 -0.0383192984889689 ...
        0.934872809320677 -0.0383192984889689 0.0197056878852779 ...
        0.0607355636607642 0.0513866085268384 0.000665620483072021 ...
        -0.0486298586989787 -0.0565028764199159 -0.0186626069377135 ...
        0.0316991385855097 0.0532714462599265 0.0309376486496485 ...
        -0.0138078286840283 -0.0433211651403085 -0.0357892839180725 ...
        -0.00130617627483517 0.0297329652336371 0.0334992132824031 ...
        0.0110306483902122 -0.0160732839479668 -0.0260611545538405 ...
        -0.0144700682726484 0.0053695710981417 0.0164322124952787 ...
        0.0124768627619328 0.00066004397733961 -0.00758292185658081 ...
        -0.00716927379385937 -0.00189017714350953 0.00164397875772264 ...
        0.00111246327165822 -0.000435632453540443 0.00056304049183348 ...
        0.00350850073093174 0.00432497424255977 0.000467573968422727 ...
        -0.00547801558023553 -0.00778285069564525 -0.00333880346249821 ...
        0.00474219424105215 0.00946434480608708 0.00637370842026181 ...
        -0.00217243267736483 -0.00894025357560687 -0.00824204533250936 ...
        -0.000899680300288119 0.00668978628521422 0.00832777966880916 ...
        0.00324917451024706 -0.00372171702732933 -0.00680156703230628 ...
        -0.00416658326482286 0.00110944324203413 0.00439411551312249 ...
        0.00360419467398028 0.000406452624585443 -0.00202226276401295 ...
        -0.00206103907539546 -0.000622836430686504 0.000412732919244857 ...
        0.000292503605352975 -0.000156418762417842 0.000127790833184467 ...
        0.00102248283081354 0.001335064714034 0.000256517990117414 ...
        -0.00151864465237471 -0.0023064443384796 -0.00111729563257338 ...
        0.00121747194984811 0.00268448846989101 0.00193562101095158 ...
        -0.000434532578079916 -0.00240257145250944 -0.00233523032602963 ...
        -0.000403436556624593 0.00166793510114932 0.0021940592435902 ...
        0.000947901936010082 -0.000821743041045206 -0.00163664876285667 ...
        -0.00104910222775769 0.000172160585434293 0.000928629717009743 ...
        0.000772704745451151 0.000121390111571906 -0.000335852091838317 ...
        -0.000319974678743598 -8.22222836667422e-05 1.48238319635741e-05 ...
        -8.27111237553569e-05 -0.000136363890798895 3.08502314606061e-05 ...
        0.000289614943313885 0.00034481604936328 7.62383463167554e-05 ...
        -0.000418939383951311 -0.00327340841804536 0.000160039296235752]);
end

y = step(Hd,x);
% Disregard sample 98, as it has an unusually high impulse response
y(98)=0;
% Bound between -1 and 1
y=y./max(abs(y));
% linearly interpolate actual value of y(98)
y(98)=-(y(97)+y(99))/2;
audiowrite('clean_PaMc.wav',y,11025);